function zixun_resize_img(oi,iw,ih){var img = new Image();img.src = oi.src;img.onload = function(){if(img.width > 0 && img.height > 0){var rate = (iw/img.width < ih/img.height)? iw/img.width: ih/img.height;var oi_width = parseInt(img.width * rate);var oi_height = parseInt(img.height * rate);if (iw - oi_width <= (iw * 0.05)){oi_width = iw;}oi.style.width = oi_width + "px";oi.style.height = oi_height + "px";var mwt = parseInt((ih - oi_height)*3/5) + "px";var mwb = parseInt((ih - oi_height)*2/5) + "px";oi.style.margin = mwt+" auto "+mwb+" auto";}};img.onload();oi.parentNode.style.visibility="inherit";}function zixun_exec_html(h){var zx = h.split('\n');var tab = [];var img = [];var cont = [];var zx_pos = 0;var max_zx_id = -1;for (var i=0; i<zx.length; i++){zx[i] = strtrim(zx[i]);if (zx[i] == "") continue;var zxl = zx[i].split('\t');var zx_id = parseInt(zxl[0]);if (zxl.length == 2 && !(/^[_0-9xy]+$/.test(zxl[1]))){tab[zx_id] = strtrim(zxl[1]);cont[zx_id] = '';zx_pos = 0;if (zx_id > max_zx_id) max_zx_id = zx_id;}if (zxl.length == 5){img[zx_id] = '<a class="img" target="_blank" href="'+strtrim(zxl[1])+'" title="'+strtrim(zxl[4])+'" zxpos="'+zx_pos+'" style="visibility:hidden"><img src="'+strtrim(zxl[3])+'" alt="'+strtrim(zxl[4])+'" onload="zixun_resize_img(this,180,135)"/><br/>'+strtrim(zxl[2])+'</a>';zx_pos++;}if (zxl.length == 3){if (zx_pos == 8) cont[zx_id] += '</div><div>';var zxl_trim = strtrim(zxl[2]);zxl_trim = zxl_trim.replace(/&quot;/g,'"').replace(/&nbsp;/g,' ').replace(/&lt;/g,'<').replace(/&gt;/g,'>');cont[zx_id] += '<span><a target="_blank" href="'+strtrim(zxl[1])+'" zxpos="'+zx_pos+'" title="'+zxl_trim.replace(/\"/g,"'")+'">'+zxl_trim+'</a></span>';zx_pos++;}}if (tab.length > 0){zx_vars.tab = tab;zx_vars.img = img;zx_vars.cont = cont;}return max_zx_id;}function fillzixun(html){html = DH.du(html);if (status_var.zixun){zx_vars.status = status_var.zixun;}else{zx_vars.status = "0_1_19_16_5_4_10_12_3_6";}var zxst = zx_vars.status;if (zxst != ""){var zx_st = zxst.split("_");zx_vars.tab_id = [];zx_vars.tab_str = [];for (var i=0; i<10; i++){if (!zx_st[i]) continue;if (arr = /^([0-9]+)([xy]?)/.exec(zx_st[i])){zx_vars.tab_id[i] = parseInt(arr[1]);zx_vars.tab_str[i] = arr[2];}}}else{zx_vars.tab_id = [];zx_vars.tab_str = [];}zx_vars.def_id = [0,1,19,16,5,4,10,12,3,6];var def_i = 0;if (zx_vars.status == "" || zx_vars.status.indexOf('x') != -1 || zx_vars.status.indexOf('y') == -1){for (var i=zx_vars.tab_id.length; i<zx_vars.def_id.length; i++){while (inar(zx_vars.tab_id,zx_vars.def_id[def_i]) > -1 && def_i < zx_vars.def_id.length) def_i++;zx_vars.tab_id[i] = zx_vars.def_id[def_i];zx_vars.tab_str[i] = '';def_i++;}}if (zx_vars.tab.length < 1 || zx_vars.cont.length < 1) return false;zx_flag = zx_vars.tab.length;var max_zx_id = zixun_exec_html(html);var str_tabs = '<div id="zixun_edit_set"><a id="setzx" href="javascript:setzixun();">设置</a><a id="reflushzx" href="javascript:reflush_zixun();" title="建议您间隔五分钟以上刷新">刷新</a></div><div id="zx_tab">';if (!zx_vars.cur_show_id || !(inar(zx_vars.tab_id,zx_vars.cur_show_id) > -1)){zx_vars.cur_show_id = -1;}for (var i=0; i<zx_vars.tab_id.length; i++){var zx_id = zx_vars.tab_id[i];if (!zx_vars.tab[zx_id]) continue;if (zx_vars.cur_show_id == -1){zx_vars.cur_show_id = zx_id;}str_tabs += '<span id="zx_tab_' + zx_id + '" onmouseover="zx_show('+zx_id+')" onmouseout="zx_showclear();"' + (zx_vars.cur_show_id == zx_id ? ' class="select"' : '') + '>' + zx_vars.tab[zx_id] + '</span>';}str_tabs += '</div>';var str_conts = '';for (var zx_id = 0; zx_id <= max_zx_id; zx_id++){if (zx_vars.tab[zx_id]){var i = inar(zx_vars.tab_id,zx_id);str_conts += '<div id="zx_cont_' + zx_id + '" st="' + (i > -1 ? zx_vars.tab_str[i]: '0') + '"' + (zx_id == zx_vars.cur_show_id ? ' style="display:block;"' : '') + ' class="zx_cont">' + zx_vars.img[zx_id] + '<div>' + zx_vars.cont[zx_id] + '</div></div>';}}if (str_conts == "") return false;$("s_zixun").innerHTML = str_tabs + str_conts;$("s_zixun").style.display = "block";$("right_3").style.display = "block";if (zx_vars.uptimes == 0){right_block.zixun = 1;zx_block_show(1);}zixun_reflush_show(1);}function zx_block_show(f){var ins_h = 204;var ihe = ($("hotandins").style.display == "block") ? 127 : 0;if (f == 1){basestyle.left_2_height += ins_h + 6;basestyle.main_height += ins_h + 6;$("left_2").style.height = basestyle.left_2_height + ihe + "px";$("right_3").style.height = ins_h + "px";$("right_3").style.display = "block";$("right_3").style.zIndex = 102;$("main").style.height = basestyle.main_height + "px";}else{basestyle.left_2_height -= ins_h + 6;basestyle.main_height -= ins_h + 6;$("left_2").style.height = basestyle.left_2_height + ihe + "px";$("right_3").style.display = "none";$("main").style.height = basestyle.main_height + "px";}}function zixun_noflush(){alert("暂时没有更新，请间隔五分钟以上刷新");}function zx_show(id){zx_vars.hover_flag = parseInt(id);zx_vars.hover_iv = window.setTimeout('zx_show_exec('+id+')',300);if (!zx_vars.iv){zx_vars.iv = setTimeout(reflush_zixun,600*1000);}}function zx_showclear(){zx_vars.hover_flag = -1;clearTimeout(zx_vars.hover_iv);}function zx_show_exec(id){if (zx_vars.hover_flag != parseInt(id) || zx_vars.hover_flag == -1) return false;if ($("zx_tab_"+id).className == "select") return false;var s_zx = $("s_zixun").getElementsByTagName("DIV");for (var mi=0; mi<s_zx.length; mi++){if (s_zx[mi].id != "zx_tab" && s_zx[mi].className == "zx_cont"){s_zx[mi].style.display = "none";var sid = s_zx[mi].id.substring(8);if ($("zx_tab_"+sid)) $("zx_tab_"+sid).className = "";}}$("zx_tab_"+id).className = "select";$("zx_cont_"+id).style.display = "block";zx_vars.cur_show_id = id;}function zixun_reflush_show(f){if (f == 0){$("reflushzx").className = "";$("reflushzx").href = "javascript:reflush_zixun()";}else{$("reflushzx").className = "forb";$("reflushzx").href = "javascript:zixun_noflush()";}if (zx_vars.iv) clearTimeout(zx_vars.iv);zx_vars.iv = setTimeout("zixun_reflush_show(0)",300*1000);}function reflush_zixun(){if (zx_vars.iv_status == 1){return;}var gu = "get_v33.php?";gu += (s_vars.apid != "") ? ("apid="+s_vars.apid+"&") : "";gu += (s_vars.m != "") ? ("m="+s_vars.m+"&") : "";gu += "block=zixun&";gu += "method=ajaf&";gu += "zxtab="+(zx_vars.status != "" ? zx_vars.status : "0_1_19_16_5_4_10_12_3_6")+"&";gu += "c="+DH.t();ajaf.ajaf_get(s_vars.dm+gu,"zixun_rcb");zx_vars.uptimes++;}function zixun_rcb(hr){var zixun_text = extract_block(hr,'zixun');if (zixun_text) fillzixun(zixun_text);}function setzixun(){zx_vars.iv_status = 1;zx_vars.isover = 0;zx_vars.old_show_id = zx_vars.cur_show_id;$("setzx").className = "on";if ($("zixun_edit")){$("zixun_edit").style.display = "block";}else{var sz_html = '<h2>您正在关注的新闻</h2><div id="zixun_edit_user" class="zixun_edit">';for (var i = 0; i < zx_vars.tab_id.length; ++i){var tab_id = zx_vars.tab_id[i];var tag_str = zx_vars.tab[tab_id];sz_html += '<a id="zx_edit_user_' + tab_id + '" href="javascript:zixun_clickdelete(' + tab_id + ');">' + tag_str + '</a>';}sz_html += '</div><h2>您还能使用的新闻</h2><div id="zixun_edit_all" class="zixun_edit">';for (var i = 0; i < zx_vars.tab.length; ++i){var zin = inar(zx_vars.tab_id,i);sz_html += '<a id="zx_edit_all_' + i + '" href="javascript:zixun_clickadd(' + i + ');"'+(zin > -1 ? ' class="off"' : '')+'>' + zx_vars.tab[i] + '</a>';}sz_html += '</div><div class="hint"><span class="tips">提示：</span><span id="zx_edit_tips">您可以点击设置需要关注的新闻，如需关闭新闻资讯版块，请到页面顶部的“个性设置”中设置</span></div><div class="zixun_edit_op"><span onclick="setzixun_ok()" class="ok">&nbsp;</span></div>';var sz = document.createElement("div");sz.id = "zixun_edit";sz.innerHTML = sz_html;sz.style.display = "block";sz.onmouseover = zixun_hover_tips;$("s_zixun").appendChild(sz);}}function zixun_hover_tips(evt){evt = evt?evt:window.event;var srcElem = (evt.target)?evt.target:evt.srcElement;try{if (srcElem.id.indexOf("edit_user") > -1){if (zx_vars.tab_id.length > 1) zixun_fill_tips(1,0);else zixun_fill_tips(3,0);}else if (srcElem.id.indexOf("edit_all") > -1){if (srcElem.className == "off") zixun_fill_tips(5,0);else if (zx_vars.tab_id.length < 10) zixun_fill_tips(2,0);else zixun_fill_tips(4,0);}else{zixun_fill_tips(0,0);}}catch(e){}}function zixun_fill_tips(i,f){var tips = ["您可以点击设置需要关注的新闻","点击可以删除您正在关注的新闻","点击可以添加您正在关注的新闻","只剩余一个频道，不能够再进行删除","您关注的新闻总数已达到十个，不能再继续添加","该新闻已经在关注列表中，不需要再行添加"];$("zx_edit_tips").innerHTML = tips[i];$("zx_edit_tips").className = f == 1 ? "red" : "";}function zixun_clickdelete(id){if (zx_vars.tab_id.length <= 1){zixun_fill_tips(3,1);return;}var i = inar(zx_vars.tab_id,id);if (i > -1){zx_vars.tab_id.splice(i,1);$("zixun_edit_user").removeChild($("zx_edit_user_"+id));$("zx_edit_all_"+id).className = "";}}function zixun_clickadd(id){if (inar(zx_vars.tab_id,id) > -1){zixun_fill_tips(5,1);return;}if (zx_vars.tab_id.length >= 10){zixun_fill_tips(4,1);return;}zx_vars.tab_id[zx_vars.tab_id.length] = id;$("zx_edit_all_"+id).className = "off";if (!$("zx_edit_user_"+id)){$("zixun_edit_user").innerHTML += '<a id="zx_edit_user_' + id + '" href="javascript:zixun_clickdelete(' + id + ');">' + $("zx_edit_all_"+id).innerHTML + '</a>';}zx_vars.cur_show_id = id;}function setzixun_ok(){zx_vars.isover = 1;$("setzx").className = "";if (!$("zixun_edit")){return;}else{$("zixun_edit").style.display = "none";}var str_tabs = "";var is_cur_in = (inar(zx_vars.tab_id,zx_vars.cur_show_id) > -1);var md_str = [];for (var i=0; i<zx_vars.tab_id.length; i++){var zx_id = zx_vars.tab_id[i];if (!zx_vars.tab[zx_id]) continue;var zx_f = is_cur_in ? (zx_id == zx_vars.cur_show_id ? true : false): (str_tabs == ""? true: false);if (!is_cur_in && zx_f){zx_vars.cur_show_id = zx_id;}str_tabs += '<span id="zx_tab_' + zx_id + '" onmouseover="zx_show('+zx_id+')" onmouseout="zx_showclear();"' + (zx_f ? ' class="select"' : '') + '>' + zx_vars.tab[zx_id] + '</span>';zx_vars.tab_str[i] = 'y';md_str[i] = zx_id+"y";}$("zx_tab").innerHTML = str_tabs;if(zx_vars.cur_show_id != zx_vars.old_show_id){$("zx_cont_" + zx_vars.cur_show_id).style.display = "block";$("zx_cont_" + zx_vars.old_show_id).style.display = "none";}zx_vars.iv_status = 0;var cur_s = md_str.join("_");if (cur_s != zx_vars.status){zx_vars.status = cur_s;callfunc("","change_zixun",cur_s+"&newzx=1");}}(function(){var zxsf = (s_vars.iptu == 3 && zx_vars.isshow == 2) || (s_vars.iptu == 4 && zx_vars.isshow != 1);if (zx_vars.setreq == 1){reflush_zixun();zx_vars.setreq = 2;}else{if (right_block.zixun_text && zxsf){try{fillzixun(right_block.zixun_text);}catch(e){}}}zx_vars.rm_func = 1;})();